{
  "job_id": "bda5844f-9243-48e5-9563-32be0de3463e",
  "binary_path": "/home/shinichi/Documents/VSC/vestigo-data/backend/analysis_workspace/tmpkat9f7zg_cspn.elf_analysis/tmpkat9f7zg_cspn.elf",
  "binary_name": "tmpkat9f7zg_cspn.elf",
  "analysis_timestamp": 1765271857.1165326,
  "execution_time": 0.8738307952880859,
  "status": "completed",
  "analysis_tool": "qiling_dynamic_analysis",
  "phases": {
    "packer_detection": {
      "packed": false
    },
    "yara_analysis": {
      "detected": [
        "RC4/ARC4"
      ],
      "total_matches": 2,
      "scan_time": 0.006
    },
    "constant_detection": {
      "algorithms_detected": [
        "cspn64_decrypt @ 0x401fb5",
        "cspn64_encrypt @ 0x401ee0"
      ],
      "count": 2
    },
    "function_symbols": {
      "detected": true,
      "count": 2
    },
    "dynamic_analysis": {
      "total_basic_blocks": 1073,
      "crypto_operations": 34723,
      "crypto_op_ratio": 16.21
    }
  },
  "verdict": {
    "crypto_detected": true,
    "confidence": "LOW",
    "confidence_score": 30,
    "reasons": [
      "2 crypto function candidates detected"
    ]
  },
  "raw_output": "/home/shinichi/Documents/VSC/vestigo-data/backend/analysis_workspace/tmpkat9f7zg_cspn.elf_analysis/tmpkat9f7zg_cspn.elf: ELF 64-bit LSB executable, x86-64, version 1 (GNU/Linux), statically linked, BuildID[sha1]=5ee5a115ba8a5da26791adec063e89d21b8171d6, for GNU/Linux 3.2.0, not stripped\n320659 14:47:36.475419 execve(\"/home/shinichi/Documents/VSC/vestigo-data/backend/analysis_workspace/tmpkat9f7zg_cspn.elf_analysis/tmpkat9f7zg_cspn.elf\", [\"/home/shinichi/Documents/VSC/vestigo-data/backend/analysis_workspace/tmpkat9f7zg_cspn.elf_analysis/tmpkat9f7zg_cspn.elf\"], [\"HOME=/home/shinichi\", \"LANG=en_IN.UTF-8\", \"LANGUAGE=en_IN:en\", \"LOGNAME=shinichi\", \"PATH=/home/shinichi/Documents/VSC/vestigo-data/qiling_analysis/qiling_env/bin:/home/shinichi/anaconda3/condabin:/usr/local/go/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/snap/bin:/home/shinichi/.l\"..., \"SHELL=/usr/bin/zsh\", \"USER=shinichi\", \"XDG_DATA_DIRS=/home/shinichi/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share/:/usr/share/:/var/lib/snapd/desktop\", \"XDG_RUNTIME_DIR=/run/user/1000\", \"GTK_MODULES=gail:atk-bridge\", \"QT_ACCESSIBILITY=1\", \"QTWEBENGINE_DICTIONARIES_PATH=/usr/share/hunspell-bdic/\", \"DBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/1000/bus\", \"DESKTOP_SESSION=ubuntu\", \"GDMSESSION=ubuntu\", \"GNOME_DESKTOP_SESSION_ID=this-is-deprecated\", \"GNOME_SHELL_SESSION_MODE=ubuntu\", \"GSM_SKIP_SSH_AGENT_WORKAROUND=true\", \"LC_ALL=en_IN.UTF-8\", \"OLDPWD=/home/shinichi/Documents/VSC/vestigo-data\", \"PWD=/home/shinichi/Documents/VSC/vestigo-data/backend\", \"QT_IM_MODULE=ibus\", \"SESSION_MANAGER=local/shinichi-hp:@/tmp/.ICE-unix/3183,unix/shinichi-hp:/tmp/.ICE-unix/3183\", \"SHLVL=1\", \"SSH_AUTH_SOCK=/run/user/1000/keyring/ssh\", \"USERNAME=shinichi\", \"XDG_CURRENT_DESKTOP=Unity\", \"XDG_MENU_PREFIX=gnome-\", \"XDG_SESSION_CLASS=user\", \"XDG_SESSION_DESKTOP=ubuntu\", \"XDG_SESSION_TYPE=wayland\", \"XMODIFIERS=@im=ibus\", \"_=/home/shinichi/Documents/VSC/vestigo-data/qiling_analysis/qiling_env/bin/uvicorn\", \"MANAGERPID=2955\", \"INVOCATION_ID=8a37068170624486b90a9ddc036042de\", \"JOURNAL_STREAM=8:25871\", \"SYSTEMD_EXEC_PID=3233\", \"MEMORY_PRESSURE_WATCH=/sys/fs/cgroup/user.slice/user-1000.slice/user@1000.service/session.slice/org.gnome.Shell@wayland.service/memory.pressure\", \"MEMORY_PRESSURE_WRITE=c29tZSAyMDAwMDAgMjAwMDAwMAA=\", \"GJS_DEBUG_OUTPUT=stderr\", \"GJS_DEBUG_TOPICS=JS ERROR;JS LOG\", \"CLUTTER_DISABLE_MIPMAPPED_TEXT=1\", \"GNOME_SETUP_DISPLAY=:1\", \"DISPLAY=:0\", \"XAUTHORITY=/run/user/1000/.mutter-Xwaylandauth.TRVZG3\", \"WAYLAND_DISPLAY=wayland-0\", \"GIO_LAUNCHED_DESKTOP_FILE=/usr/share/applications/code.desktop\", \"GIO_LAUNCHED_DESKTOP_FILE_PID=50712\", \"CHROME_DESKTOP=code.desktop\", \"ORIGINAL_XDG_CURRENT_DESKTOP=ubuntu:GNOME\", \"GDK_BACKEND=x11\", \"TERM_PROGRAM=vscode\", \"TERM_PROGRAM_VERSION=1.104.1\", \"COLORTERM=truecolor\", \"PYDEVD_DISABLE_FILE_VALIDATION=1\", \"VSCODE_DEBUGPY_ADAPTER_ENDPOINTS=/home/shinichi/.vscode/extensions/ms-python.debugpy-2025.16.0-linux-x64/.noConfigDebugAdapterEndpoints/endpoint-df7bba9d2050d29c.txt\", \"BUNDLED_DEBUGPY_PATH=/home/shinichi/.vscode/extensions/ms-python.debugpy-2025.16.0-linux-x64/bundled/libs/debugpy\", \"GIT_ASKPASS=/usr/share/code/resources/app/extensions/git/dist/askpass.sh\", \"VSCODE_GIT_ASKPASS_NODE=/usr/share/code/code\", \"VSCODE_GIT_ASKPASS_EXTRA_ARGS=\", \"VSCODE_GIT_ASKPASS_MAIN=/usr/share/code/resources/app/extensions/git/dist/askpass-main.js\", \"VSCODE_GIT_IPC_HANDLE=/run/user/1000/vscode-git-67cc46b964.sock\", \"PYTHONSTARTUP=/home/shinichi/.config/Code/User/workspaceStorage/867f476673ca5685af06206f486a93e2/ms-python.python/pythonrc.py\", \"PYTHON_BASIC_REPL=1\", \"VSCODE_INJECTION=1\", \"VSCODE_NONCE=bcd3f7ee-01a7-4f7b-a433-33e0db1a2b43\", \"ZDOTDIR=/home/shinichi\", \"USER_ZDOTDIR=/home/shinichi\", \"TERM=xterm-256color\", \"P9K_TTY=old\", \"_P9K_TTY=/dev/pts/3\", \"ZSH=/home/shinichi/.oh-my-zsh\", \"PAGER=less\", \"LESS=-R\", \"LSCOLORS=Gxfxcxdxbxegedabagacad\", \"LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=00:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lz\"..., \"P9K_SSH=0\", \"_P9K_SSH_TTY=/dev/pts/3\", \"CONDA_EXE=/home/shinichi/anaconda3/bin/conda\", \"_CE_M=\", \"_CE_CONDA=\", \"CONDA_PYTHON_EXE=/home/shinichi/anaconda3/bin/python\", \"CONDA_SHLVL=0\", \"VSCODE_PYTHON_AUTOACTIVATE_GUARD=1\", \"VIRTUAL_ENV=/home/shinichi/Documents/VSC/vestigo-data/qiling_analysis/qiling_env\", \"PS1=(qiling_env) ${$((_p9k_on_expand()))+}%{${_p9k__raw_msg-}${_p9k__raw_msg::=}%}${(e)_p9k_t[7]}${_p9k__1-${${:-${_p9k__d::=0}${_p9k__rprompt::=${_p9k__1r-${${:-${_p9k__bg::=NONE}${_p9k__i::=0}${_p9k__sss::=}}+}${${:-${P9K_CONTENT::=}${_p9k__n::=}${${${_p\"..., \"VIRTUAL_ENV_PROMPT=(qiling_env) \", \"DATABASE_URL=postgresql://neondb_owner:npg_dIu37VLkSEjq@ep-morning-art-a1952yzh-pooler.ap-southeast-1.aws.neon.tech/neondb?sslmode=require&channel_binding=require\", \"GHIDRA_HOME=/opt/ghidra/ghidra_11.4.2_PUBLIC\", \"OPENAI_API_KEY=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\", \"PERPLEXITY_API_KEY=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\"]) = -1 EACCES (Permission denied)\n320659 14:47:36.476458 +++ exited with 1 +++\n[*] Analysis output will be saved to: /home/shinichi/Documents/VSC/vestigo-data/qiling_analysis/tests/analysis_logs/analysis_tmpkat9f7zg_cspn_elf_20251209_144736.log\n[*] Starting analysis at: 2025-12-09 14:47:36\n\n======= FILE DESCRIPTON ======\n\n============================================================\n[*] PHASE -1: Checking for packed binary...\n[-] No packer detected\n[+] Detected architecture: x86_64\n[*] Target: tmpkat9f7zg_cspn.elf\n[*] Rootfs: /home/shinichi/Documents/VSC/vestigo-data/qiling_analysis/rootfs/x8664_linux\n\n============================================================\n[*] PHASE 0: YARA static analysis\n[\u2713] YARA detected: RC4/ARC4\n    Total matches: 2\n    Scan time: 0.006s\n    High-confidence rules:\n      - RC4_Identity_Permutation (RC4/ARC4, 90%)\n\n============================================================\n[*] PHASE 1: Scanning for crypto constants...\n[-] No crypto constants detected\n\n============================================================\n[*] PHASE 2: Checking for function symbols...\n[*] Found 2 crypto candidate(s):\n    - cspn64_decrypt @ 0x401fb5\n    - cspn64_encrypt @ 0x401ee0\n\n============================================================\n[*] PHASE 3: Running binary to test crypto functions...\n\n======================================================================\n   NATIVE STRACE ANALYSIS (Optional)\n======================================================================\n[*] Running native strace on binary...\n    Strace log: /home/shinichi/Documents/VSC/vestigo-data/qiling_analysis/tests/strace_logs/strace_tmpkat9f7zg_cspn_elf_20251209_144736.log\n    Terminal output: /home/shinichi/Documents/VSC/vestigo-data/qiling_analysis/tests/strace_logs/terminal_tmpkat9f7zg_cspn_elf_20251209_144736.log\n[\u2713] strace log captured: 5079 bytes\n[\u2713] Terminal output captured: 32 bytes\n[*] Analyzing strace log...\n[*] Strace Statistics:\n    Total syscalls: 2\n[*] Installing syscall hooks (getrandom, read)...\n[*] Executing binary with basic block profiling...\n[SYSCALL] getrandom() called: 8 bytes (0x8)\n          Data: c6438e3275a28c39\n          Likely: XOR-based cipher (8-byte key)\n\n============================================================\n   ENHANCED ANALYSIS RESULTS (v2.0)\n============================================================\n\n[!] Binary execution failed or crashed early\n[*] Falling back to static analysis results only\n\n\n[*] Constant Detection:\n    [-] No known crypto constants found\n\n[*] Avalanche Effect Analysis:\n    [-] Note: Functions may be inlined or not called during this execution\n    [-] Unable to capture I/O through function hooks\n    [-] Note: Binary executed and produced output (check console above)\n    [*] Avalanche testing requires multiple runs with different inputs\n    [*] Alternative: Test manually by running binary multiple times\n\n[*] Basic Block Analysis:\n    Total Basic Blocks: 1073\n    Crypto Loops: 47\n    Total Instructions: 214244\n    Crypto Operations: 34723\n    Crypto-Op Ratio: 16.21%\n\n[*] ADAPTIVE Confidence Scoring (0-100):\n    - Constants evidence : 0 pts (0-40)\n    - Function names     : 15 pts (0-40, adaptive)\n    - Crypto loops       : 20 pts (0-20)\n    - Crypto-op ratio    : 15 pts (0-15)\n    - Avalanche effect   : 0 pts (0-15, optional)\n    - YARA detection     : 0 pts (0-30)\n    -> RAW TOTAL: 50\n    -> FINAL SCORE: 50/100  => MEDIUM\n    Evidence sources: 3/5 available\n\n\n[*] Strace log saved to: /home/shinichi/Documents/VSC/vestigo-data/qiling_analysis/tests/strace_logs/strace_tmpkat9f7zg_cspn_elf_20251209_144736.log\n[*] Terminal output saved to: /home/shinichi/Documents/VSC/vestigo-data/qiling_analysis/tests/strace_logs/terminal_tmpkat9f7zg_cspn_elf_20251209_144736.log\n\n======================================================================\n   STRACE LOG CONTENTS\n======================================================================\n\n[*] Analysis completed at: 2025-12-09 14:47:37\n[\u2713] Full analysis log saved to: /home/shinichi/Documents/VSC/vestigo-data/qiling_analysis/tests/analysis_logs/analysis_tmpkat9f7zg_cspn_elf_20251209_144736.log\n",
  "errors": "/home/shinichi/Documents/VSC/vestigo-data/qiling_analysis/qiling_env/lib/python3.12/site-packages/capstone/__init__.py:267: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.\n  import pkg_resources\n[!] \t0x42397c: syscall ql_syscall_rseq number = 0x14e(334) not implemented\n[x] \tSyscall ERROR: ql_syscall_write DEBUG: write() argument must be str, not bytearray\nTraceback (most recent call last):\n  File \"/home/shinichi/Documents/VSC/vestigo-data/qiling_analysis/qiling/qiling/os/posix/posix.py\", line 213, in load_syscall\n    retval = syscall_hook(self.ql, *params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/shinichi/Documents/VSC/vestigo-data/qiling_analysis/qiling/qiling/os/posix/syscall/unistd.py\", line 428, in ql_syscall_write\n    f.write(data)\n  File \"/home/shinichi/Documents/VSC/vestigo-data/qiling_analysis/tests/verify_crypto.py\", line 34, in write\n    self.terminal.write(message)\nTypeError: write() argument must be str, not bytearray\n"
}